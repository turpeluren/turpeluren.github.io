
const jsondata = '{'+
    '"y2018": {'+
        '"jan1": {'+
            '"n1": "xsvUvrE",'+
            '"n2": "na7Clg7",'+
            '"n3": "zXN6UWC",'+
            '"n4": "oLX18RW",'+
            '"n5": "kIzMRCs",'+
            '"n6": "PTTKDK8",'+
            '"n7": "U0QAFOv",'+
            '"n8": "n0lDiad",'+
            '"n9": "Jvkztea",'+
            '"n10": "n0FPtEp",'+
            '"n11": "",'+
            '"n12": "",'+
            '"n13": "",'+
            '"n14": "",'+
            '"n15": "",'+
            '"n16": "",'+
            '"n17": "",'+
            '"n18": "",'+
            '"n19": "",'+
            '"n20": "",'+
            '"n21": "",'+
            '"n22": "",'+
            '"n23": "",'+
            '"n24": "",'+
            '"n25": "",'+
            '"n26": "",'+
            '"n27": "",'+
            '"n28": "",'+
            '"n29": "",'+
            '"n30": "",'+
            '"n31": ""'+
        '},'+
        '"feb2": {'+
            
        '},'+
        '"mar3": {'+

        '},'+
        '"apr4": {'+
            '"n10": "R68yNfU"'+
        
        '},'+
        '"maj5": {'+

        '},'+
        '"jun6": {'+
            
        '},'+
        '"jul7": {'+

        '},'+
        '"aug8": {'+
            
        '},'+
        '"sep9": {'+

        '},'+
        '"okt10": {'+
            
        '},'+
        '"nov11": {'+

        '},'+
        '"dec12": {'+
            
        '}'+
    '},'+
    '"y2019": {'+
        '"jan1": {'+

        '},'+
        '"feb2": {'+
            
        '},'+
        '"mar3": {'+

        '},'+
        '"apr4": {'+
        
        '},'+
        '"maj5": {'+

        '},'+
        '"jun6": {'+
            
        '},'+
        '"jul7": {'+

        '},'+
        '"aug8": {'+
            
        '},'+
        '"sep9": {'+

        '},'+
        '"okt10": {'+
            
        '},'+
        '"nov11": {'+

        '},'+
        '"dec12": {'+
            
        '}'+
    '},'+
    '"y2020": {'+
        '"jan1": {'+

        '},'+
        '"feb2": {'+
            
        '},'+
        '"mar3": {'+

        '},'+
        '"apr4": {'+
        
        '},'+
        '"maj5": {'+

        '},'+
        '"jun6": {'+
            
        '},'+
        '"jul7": {'+

        '},'+
        '"aug8": {'+
            
        '},'+
        '"sep9": {'+

        '},'+
        '"okt10": {'+
            
        '},'+
        '"nov11": {'+

        '},'+
        '"dec12": {'+
            
        '}'+
    '},'+
    '"y2021": {'+
        '"jan1": {'+
            
        '},'+
        '"feb2": {'+
            
        '},'+
        '"mar3": {'+

        '},'+
        '"apr4": {'+
            
        '},'+
        '"maj5": {'+

        '},'+
        '"jun6": {'+
            
        '},'+
        '"jul7": {'+

        '},'+
        '"aug8": {'+
            
        '},'+
        '"sep9": {'+

        '},'+
        '"okt10": {'+
            
        '},'+
        '"nov11": {'+
            '"n13": "lLHotkQ"'+
        '},'+
        '"dec12": {'+
            '"n3": "ZxLCTHw",'+
            '"n24": "l8Iag8t",'+
            '"n31": "O2f81WH"'+
        '}'+
    '}'+
'}';

const arraydata = [
    ["1 jan 2018", "xsvUvrE"],
    ["2 jan 2018", "na7Clg7"],
    ["3 jan 2018", "zXN6UWC"],
    ["4 jan 2018", "oLX18RW"],
    ["5 jan 2018", "kIzMRCs"],
    ["6 jan 2018", "PTTKDK8"],
    ["7 jan 2018", "U0QAFOv"],
    ["8 jan 2018", "n0lDiad"],
    ["9 jan 2018", "Jvkztea"],
    ["10 jan 2018", "n0FPtEp"],
    ["11 jan 2018", "OWJ5BQc"],
    ["12 jan 2018", "T0NADA5"],
    ["13 jan 2018", "S03eNyx"],
    ["14 jan 2018", "3KY19TQ"],
    ["15 jan 2018", "vY1XybU"],
    ["16 jan 2018", "d985VN4"],
    ["17 jan 2018", "UkLvolh"],
    ["18 jan 2018", "kpmaP5c"],
    ["19 jan 2018", "6hP5niz"],
    ["20 jan 2018", "6apg3OG"],
    ["21 jan 2018", "I8hiZif"],
    ["22 jan 2018", "ncGfZ1j"],
    ["23 jan 2018", "GELgnjH", "There is another image from this day with other lighting.", "gKGjuZ3"],
    ["24 jan 2018", "vikBvin"],
    ["25 jan 2018", "9XrCIIa"],
    
    ["1 feb 2018", "fPhXehd"],
    ["2 feb 2018", "gSN6IEv"],
    ["3 feb 2018", "guqVwMY"],
    ["4 feb 2018", "OVlvNH8"],
    ["5 feb 2018", "wvJhsB5"],
    ["6 feb 2018", "Ugk1AaB"],
    ["7 feb 2018", "EEKdt7M"],
    ["8 feb 2018", "Rk9Qxpd"],
    ["9 feb 2018", "bXcp0We"],
    ["10 feb 2018", "Adzz2K9", "My 17th birthday!"],
    ["11 feb 2018", "hzbAzy9"],
    ["12 feb 2018", "epz76A2"],
    ["13 feb 2018", "EZaiVkb"],
    ["14 feb 2018", "giSX5fh"],
    ["15 feb 2018", "C1qnQi5"],
    ["16 feb 2018", "vjR5Kby"],
    ["17 feb 2018", "BxSZOPJ"],
    ["18 feb 2018", "cUSyC1n"],
    ["19 feb 2018", "l4ttgJ5"],
    ["20 feb 2018", "u1zf0x4"],
    ["21 feb 2018", "wVW1XOm"],
    ["22 feb 2018", "WQK8SA0"],
    ["23 feb 2018", "qQW8mYB"],
    ["24 feb 2018", "2Gjt2zh"],
    ["25 feb 2018", "IGGGuoA"],
    ["26 feb 2018", "vtt9473"],
    ["27 feb 2018", "MKtPopr"],
    ["28 feb 2018", "4u8YJHM"],

    ["1 mar 2018", "N6zLH4i"],
    ["2 mar 2018", "HWPMSRr"],
    ["3 mar 2018", "dJu4e43"],
    ["4 mar 2018", "P3VkpOe"],
    ["5 mar 2018", "cZbjQjQ"],
    ["6 mar 2018", "3vuPkY2"],
    ["7 mar 2018", "CRlBtx1"],
    ["8 mar 2018", "Vq45Tfc"],
    ["9 mar 2018", "MPLOpVY"],
    ["10 mar 2018", "wWcCOOx"],
    ["11 mar 2018", "c3HxXgN"],
    ["12 mar 2018", "AA7lhzr"],
    ["13 mar 2018", "2n8PD2d"],
    ["14 mar 2018", "UUKRezE"],
    ["15 mar 2018", "Vl5gYwe"],
    ["16 mar 2018", "aYNmrz4"],
    ["17 mar 2018", "MQLE4q8"],
    ["18 mar 2018", "6i4N6TN"],
    ["19 mar 2018", "4HCMuvk"],
    ["20 mar 2018", "o8Enl7s"],
    ["21 mar 2018", "he1XGeG"],
    ["22 mar 2018", "aMHE4EB"],
    ["23 mar 2018", "CZiq0c9"],
    ["24 mar 2018", "MEhQwMN"],
    ["25 mar 2018", "vRTj8B3"],
    ["26 mar 2018", "HOQFRm3"],
    ["27 mar 2018", "j6vVAGa"],
    ["28 mar 2018", "WIR0VmT"],
    ["29 mar 2018", "CXEdnAk"],
    ["30 mar 2018", "Lvshgsf"],
    
    
    ["1 apr 2018", "gBg2NPf"],
    ["2 apr 2018", "8dMTiCh"],
    ["3 apr 2018", "SPhSCiI"],
    ["4 apr 2018", "To6IiTc"],
    ["5 apr 2018", "0Hwq4iG"],
    ["6 apr 2018", "zYga3FR"],
    ["7 apr 2018", "Y60qBYD"],
    ["8 apr 2018", "XXGf5Hm"],
    ["9 apr 2018", "XUjnlcY"],
    ["10 apr 2018", "R68yNfU"],
    ["11 apr 2018", "OTP89dV"],
    ["12 apr 2018", "imFohsk"],
    ["13 apr 2018", "yosXpuS"],
    ["14 apr 2018", "KNhDgIV"],
    ["15 apr 2018", "RrmphnJ"],
    ["16 apr 2018", "79tMFAp"],
    ["17 apr 2018", "cObJPP1"],
    ["18 apr 2018", "MLZ9YZ8"],
    ["19 apr 2018", "FQJMBYt"],
    ["20 apr 2018", "7tbdehd"],
    ["21 apr 2018", "5aP8TPT"],
    ["22 apr 2018", "ReTXP5g"],
    ["23 apr 2018", "YVdaAER"],
    ["24 apr 2018", "XFPBaae"],
    ["25 apr 2018", "qgmztC3"],
    ["26 apr 2018", "eyVGUoK"],
    ["27 apr 2018", "c4IvfmW"],
    ["28 apr 2018", "ovH2wea"],
    ["29 apr 2018", "syYEkoI"],
    ["30 apr 2018", "lgvJVez"],
    
    ["1 maj 2018", "wkAQhKW"],
    ["2 maj 2018", "1TGcLHy"],
    ["3 maj 2018", "lIehIHc"],
    ["4 maj 2018", "KG2oqYn"],
    ["5 maj 2018", "KwV9Zfp"],
    ["6 maj 2018", "gmuLwCg"],
    ["7 maj 2018", "GkEnI9c"],
    ["8 maj 2018", "jVxyvRC"],
    ["10 maj 2018", "TUJu6ht"],
    ["11 maj 2018", "XvzVGiw"],
    ["12 maj 2018", "X5e7C4N"],
    ["13 maj 2018", "yqjxwNe"],
    ["14 maj 2018", "UYP6DIA"],
    ["15 maj 2018", "I4bDItX"],
    ["16 maj 2018", "s7giIUB"],
    ["17 maj 2018", "APDzOV7"],
    ["18 maj 2018", "NfIbbO8"],
    ["19 maj 2018", "jgHIy3Z"],
    ["20 maj 2018", "4TYNfY3"],
    ["21 maj 2018", "vSwJOMs"],
    ["22 maj 2018", "vEKt477"],
    ["23 maj 2018", "BpyOT9o"],
    ["24 maj 2018", "cC6voyn"],
    ["25 maj 2018", "oRtFIB6"],
    ["26 maj 2018", "RmyAHzD"],
    ["27 maj 2018", "Uhd1M9N"],
    ["28 maj 2018", "ff5uluU"],
    ["29 maj 2018", "n7fbD2D"],
    ["30 maj 2018", "HoT92wR"],
    ["31 maj 2018", "G9jx6og"],

    ["1 jun 2018", "4lsfSfU"],
    ["2 jun 2018", "XMiItVE"],
    ["3 jun 2018", "9hqzUcW"],
    ["4 jun 2018", "T7TYBco"],
    ["6 jun 2018", "2syqMuu"],
    ["7 jun 2018", "3C8R8v2"],
    ["8 jun 2018", "p1664ed"],
    ["10 jun 2018", "Gsalkue"],
    ["11 jun 2018", "NiAjZvO"],
    ["12 jun 2018", "M9UEwuS"],
    ["13 jun 2018", "p8B0LVE"],
    ["14 jun 2018", "OC9I8aT"],
    ["15 jun 2018", "qNU7f4F"],
    ["16 jun 2018", "ZVtgGHj"],
    ["17 jun 2018", "mSkABoz"],
    ["18 jun 2018", "C6lbQ93"],
    ["19 jun 2018", "3Cx0Fvz"],
    ["20 jun 2018", "mSLjYG3"],
    ["21 jun 2018", "ADuzv1M"],
    ["22 jun 2018", "YBUmpkj"],
    ["23 jun 2018", "pZivYqR"],
    ["24 jun 2018", "74g1CgW"],
    ["25 jun 2018", "vOZPFqO"],
    ["26 jun 2018", "LxpQrn7"],
    ["27 jun 2018", "xrzIA57"],
    ["28 jun 2018", "KoaAsLx"],
    ["29 jun 2018", "5mx01xU"],

    ["1 jul 2018", "T5HNTX3"],
    ["2 jul 2018", "rSwaHyL"],
    ["3 jul 2018", "0gmH2YX"],
    ["4 jul 2018", "BLWDMuV"],
    ["5 jul 2018", "nKs0ZvW"],
    ["6 jul 2018", "1bIRn5R"],
    ["7 jul 2018", "fgGunvz"],
    ["8 jul 2018", "AIwlbNJ"],
    ["9 jul 2018", "EEvFlaw"],
    ["10 jul 2018", "GMCillB"],
    ["11 jul 2018", "t1v4RZa"],
    ["12 jul 2018", "I4rPfB0"],
    ["13 jul 2018", "OALD52r"],
    ["14 jul 2018", "lqFGifU"],
    ["15 jul 2018", "ObQXPag"],
    ["16 jul 2018", "16il2YR"],
    ["17 jul 2018", "d3YcWRZ"],
    ["18 jul 2018", "xFRQvSs"],
    ["19 jul 2018", "Pc9J0po"],
    ["20 jul 2018", "3gftJu8"],
    ["21 jul 2018", "aw0Gvoj"],
    ["23 jul 2018", "ki4cxds"],
    ["24 jul 2018", "yw7QoFO"],
    ["25 jul 2018", "eEAi2ib"],
    ["26 jul 2018", "TAIcvz0"],
    ["27 jul 2018", "g192GpC"],
    ["29 jul 2018", "fJ8V20l"],
    ["30 jul 2018", "sjojS3C"],
    ["31 jul 2018", "LFPTotY"],

    ["1 aug 2018", "s2weGg4"],
    ["4 aug 2018", "lX2EW88"],
    ["5 aug 2018", "ylfkZPr"],
    ["6 aug 2018", "55B0fm1"],
    ["7 aug 2018", "i1iwQY4"],
    ["8 aug 2018", "cJyjRHT"],
    ["9 aug 2018", "dPhc3GO"],
    ["10 aug 2018", "06KLRbc"],
    ["13 aug 2018", "DwrHjbO"],
    ["14 aug 2018", "CSoGFck"],
    ["15 aug 2018", "cjmKqsj"],
    ["16 aug 2018", "yVybnv3"],
    ["17 aug 2018", "bXcm9Ip"],
    ["18 aug 2018", "DhwBaaa"],
    ["19 aug 2018", "GYVMZeC"],
    ["20 aug 2018", "PCbX3fW"],
    ["21 aug 2018", "Lcgd04x"],
    ["22 aug 2018", "zTE40si"],
    ["23 aug 2018", "Rt7CjAQ"],
    ["24 aug 2018", "7Fc8H26"],
    ["26 aug 2018", "8yO5FUf"],
    ["27 aug 2018", "Ocvy6xR"],
    ["28 aug 2018", "PTkTmlI"],
    ["29 aug 2018", "9kORdt9"],
    ["30 aug 2018", "JGR1wtO"],
    ["31 aug 2018", "bvuLgUm"],
    
    ["2 sep 2018", "k1OSVBn"],
    ["3 sep 2018", "1GfbOej"],
    ["4 sep 2018", "SqeiU2N"],
    ["5 sep 2018", "ttxigKE"],
    ["6 sep 2018", "P1eAh1J"],
    ["7 sep 2018", "YRnlLCq"],
    ["8 sep 2018", "PUxiHPj"],
    ["9 sep 2018", "EkmPagF"],
    ["10 sep 2018", "6uKWrHp"],
    ["11 sep 2018", "zzQeatn"],
    ["12 sep 2018", "q9eAvhf"],
    ["13 sep 2018", "tWQGKJ2"],
    ["14 sep 2018", "isYJhRZ"],
    ["16 sep 2018", "uiKX32r"],
    ["17 sep 2018", "JVHLQsL"],
    ["18 sep 2018", "JQ3xwYQ"],
    ["19 sep 2018", "Z5dRyqy"],
    ["20 sep 2018", "ieKR82G"],
    ["21 sep 2018", "Xlzy9gq"],
    ["22 sep 2018", "BiTgWr9"],
    ["23 sep 2018", "ZVEVabv"],
    ["24 sep 2018", "R5fiKrV"],
    ["25 sep 2018", "3d1FXq1"],
    ["26 sep 2018", "OSclokI"],
    ["27 sep 2018", "fmFBp2H"],
    ["28 sep 2018", "CMK9w2D"],
    ["29 sep 2018", "t1kt2EX"],
    ["30 sep 2018", "iDRpzEc"],
    
    ["1 okt 2018", "iBku6b2"],
    ["2 okt 2018", "BC9vnUf"],
    ["3 okt 2018", "t0rtq1w"],
    ["4 okt 2018", "ZKlz5EA"],
    ["5 okt 2018", "0k3zafw"],
    ["6 okt 2018", "wYRKWJR"],
    ["7 okt 2018", "xoZ3RYL"],
    ["8 okt 2018", "1Ns62ce"],
    ["9 okt 2018", "bL0K9yI"],
    ["10 okt 2018", "m4LtTcB"],
    ["11 okt 2018", "kOcsfmC"],
    ["12 okt 2018", "blj3Edg"],
    ["13 okt 2018", "dO3BaG5"],
    ["14 okt 2018", "p3h77HX"],
    ["15 okt 2018", "V04FXTf"],
    ["16 okt 2018", "L7B1XJ5"],
    ["17 okt 2018", "FK4AvYQ"],
    ["18 okt 2018", "R7CPwAr"],
    ["19 okt 2018", "kHO5jzQ"],
    ["20 okt 2018", "AnziGsk"],
    ["21 okt 2018", "E4TqAEI"],
    ["22 okt 2018", "edhaA7G"],
    ["23 okt 2018", "heWQcPX"],
    ["24 okt 2018", "fjCL9wO"],
    ["25 okt 2018", "Ke1FmnI"],
    ["26 okt 2018", "1grk00Z"],
    ["27 okt 2018", "tX8fIDX"],
    ["28 okt 2018", "OiXyDPm"],
    ["30 okt 2018", "vQWncJc"],

    ["1 nov 2018", "YJtkWMw"],
    ["2 nov 2018", "2Ly6A9a"],
    ["3 nov 2018", "6tkVWOu"],
    ["4 nov 2018", "gdDsB6Y"],
    ["5 nov 2018", "AEEjYgv"],
    ["6 nov 2018", "A3ZnEsW"],
    ["7 nov 2018", "joRziwI"],
    ["8 nov 2018", "qtopJFT"],
    ["10 nov 2018", "291zGrc"],
    ["11 nov 2018", "w3EnDLQ"],
    ["12 nov 2018", "FMau7Dp"],
    ["13 nov 2018", "3IpPx3S"],
    ["14 nov 2018", "StF22vp"],
    ["16 nov 2018", "ScrLDGI"],
    ["17 nov 2018", "zUqcaWA"],
    ["18 nov 2018", "SImeSuq"],
    ["19 nov 2018", "JYPfTCF"],
    ["20 nov 2018", "tKvh2qT"],
    ["21 nov 2018", "8WBa7sW"],
    ["22 nov 2018", "siI7SUx"],
    ["23 nov 2018", "EKIT8OA"],
    ["24 nov 2018", "noOi80d"],
    ["25 nov 2018", "ZK5Ipua"],
    ["26 nov 2018", "WcRXU4X"],
    ["27 nov 2018", "QoV5t8O"],
    ["28 nov 2018", "Yt81k4U"],
    ["29 nov 2018", "VswxOxI"],
    ["30 nov 2018", "ZkyoLSR"],

    ["1 dec 2018", "3OcAUAw"],
    ["2 dec 2018", "jA01y2s"],
    ["3 dec 2018", "ObpukrJ"],
    ["4 dec 2018", "t3o8HLf"],
    ["5 dec 2018", "HcQP2rh"],
    ["6 dec 2018", "1pGCZQb"],
    ["7 dec 2018", "OiVqgsj"],
    ["8 dec 2018", "HR6Qvp0"],
    ["9 dec 2018", "8CdtTUG"],
    ["10 dec 2018", "PZCPSvb"],
    ["11 dec 2018", "ZhcOv5U"],
    ["12 dec 2018", "p2QieD0"],
    ["13 dec 2018", "4RjrKtO"],
    ["14 dec 2018", "B3tCA8R"],
    ["15 dec 2018", "HDhTUWx"],
    ["16 dec 2018", "HANZOJB"],
    ["17 dec 2018", "zdQhsBI"],
    ["18 dec 2018", "0dOQ524"],
    ["19 dec 2018", "L5K8fFE"],
    ["20 dec 2018", "wMfXDWU"],
    ["21 dec 2018", "3Wzg84L"],
    ["22 dec 2018", "n5wRgGR"],
    ["23 dec 2018", "vc30hJR"],
    ["24 dec 2018", "gEe0ZZb"],
    ["25 dec 2018", "uLPBJlh"],
    ["26 dec 2018", "7PxCbho"],
    ["27 dec 2018", "L8BzDip"],
    ["28 dec 2018", "hstHf15"],
    ["29 dec 2018", "epKhV4i"],
    ["30 dec 2018", "A2s6OW2"],
    ["31 dec 2018", "Rj8jdsP"],
    
    ["3 jan 2019", "bjc1yCf"],
    ["4 jan 2019", "oJ8oVd1"],
    ["5 jan 2019", "LxiAaXE"],
    ["6 jan 2019", "gS91bfN"],
    ["7 jan 2019", "xTw5XlD"],
    ["8 jan 2019", "IBQjBKs"],
    ["9 jan 2019", "oWFC9mb"],
    ["10 jan 2019", "TI1M8dg"],
    ["11 jan 2019", "lCVFRH7"],
    ["12 jan 2019", "lBHpEZ3"],
    ["13 jan 2019", "IRlmsqD"],
    ["14 jan 2019", "CUytOsm"],
    ["15 jan 2019", "TdRGHVE"],
    ["16 jan 2019", "EJ5zbe9"],
    ["17 jan 2019", "Ob4IHVV"],
    ["19 jan 2019", "ULSAuyq"],
    ["20 jan 2019", "xiiv5LZ"],
    ["21 jan 2019", "7BYK5Mn"],
    ["22 jan 2019", "S9ymCqX"],
    ["23 jan 2019", "akcST1o"],
    ["24 jan 2019", "UtaK7iz"],
    ["25 jan 2019", "LtdtCT5"],
    ["26 jan 2019", "RkDeHJ0"],
    ["27 jan 2019", "rP2rekR"],
    ["28 jan 2019", "nimtJaA"],
    ["31 jan 2019", "Nz9c80E"],
    
    
    ["11 nov 2021", "lLHotkQ"],

    ["3 dec 2021", "ZxLCTHw"],
    ["24 dec 2021", "l8Iag8t"],
    ["31 dec 2021", "O2f81WH"]
];

(function () {
    //'use strict';


    /*const data = JSON.parse(jsondata);*/
    const data = arraydata;
    /*const pointer = ["y2021", "dec12", "n31"];*/
    let pointer = data.length-1;
    const playBtn = document.getElementsByClassName('play')[0];
    const playIcon = playBtn.children[0];
    const backBtn = document.getElementsByClassName('backStep')[0];
    const forwBtn = document.getElementsByClassName('frontStep')[0];
    const firstBtn = document.getElementsByClassName('firstStep')[0];
    const lastBtn = document.getElementsByClassName('lastStep')[0];
    const date = document.getElementById('date');
    const imgContainer = document.getElementsByClassName('imgContainer')[0];
    const img = document.getElementById('image');
    const oldimg = document.getElementById('lastImage');
    const slider = document.getElementById('fpsSlider').children[1];
    const onionSlider = document.getElementById('onionSlider').children[1];
    const settingsBtn = document.getElementById('settings');
    const settingsBackground = document.getElementsByClassName('settingsBackground')[0];
    const settingsMenu = document.getElementsByClassName('settingsMenu')[0];
    //const timePointer = document.getElementsByClassName('timePointer')[0];
    const timelineSlider = document.getElementsByClassName('timeSlider')[0];
    let imgURL = "";

    console.log(timelineSlider);
    console.log(slider);

    playBtn.addEventListener('click', play);
    backBtn.addEventListener('click', stepBack);
    forwBtn.addEventListener('click', stepForward);
    firstBtn.addEventListener('click', gotoFirst);
    lastBtn.addEventListener('click', gotoLast);
    slider.addEventListener('input', updateFps);
    onionSlider.addEventListener('input', updateOnionTime);
    settingsBtn.addEventListener('click',toggleSettings);
    settingsBackground.addEventListener('click', toggleSettings);
    //timePointer.addEventListener('click', slideTimeline);
    timelineSlider.addEventListener('input', slideToImage);
    oldimg.style.opacity = 0;

    document.addEventListener('keydown', function(event) {
        if(event.key == "s") {
            toggleSettings();
        }
        if(event.keyCode == 32) {
            play();
        }
    });

    img.addEventListener("load", event => {
        //onload for the image, if playing change to next image
        var image = document.querySelector('img');
        var isLoaded = image.complete && image.naturalHeight !== 0;
        if (isPlaying) {
            changeImage(1);
            animateLastFrame(0);
            //set timeout to not change image too fast
            isPlaying = false;
            clearTimeout(playTimeout);
            playTimeout = setTimeout(resumePlaying, fps);
        }
    });

    var yy, mm, dd;
    let size = 'h'; //t: thumbnail, m: medium, l: large, h: huge: tom string: stÃ¶rsta
    var playTimeout;
    var isPlaying = false;
    var fps = (1000 / slider.value);
    var id = [];
    var onionskin = [];
    var adir = [];
    var pos = [];
    var onionTime = onionSlider.value;

    updateImage();

    function toggleSettings() {
        settingsMenu.classList.toggle('hidden');
        settingsBackground.classList.toggle('hidden');
    }

    function updateImage() {
        // display image from the json object
        //  using the pointer array
        //imgURL = eval("data."+pointer[0]+"."+pointer[1]+"."+pointer[2]);
        oldimg.src = img.src;
        imgURL = data[pointer][1];
        console.log(data[pointer][1])
        img.src = "";
        img.src = "https://imgur.com/" + imgURL + size + ".jpg";

        //update date
        date.innerHTML = getDate();

        //update timeline
        updateTimeLine();
    }

    function animateLastFrame(dir) {
        var nr = onionskin.length;
        console.log(nr)
        onionskin[nr] = document.createElement('img');
        onionskin[nr].classList.add('lastImage');
        onionskin[nr].src = oldimg.src;
        onionskin[nr].style.zIndex = String(1000000000-nr);
        imgContainer.appendChild(onionskin[nr]);
        adir[nr] = dir;
        pos[nr] = 0;
        //var width = onionskin[nr].offsetWidth;
        clearInterval(id[nr]);
        id[nr] = setInterval(function(){frame(nr)}, 1);
        function frame(nr) {
            if (Math.abs(pos[nr]) >= 1) {
                clearInterval(id[nr]);
                console.log(1-Math.abs(pos[nr])/1)
                onionskin[nr].remove();
            } else {
                pos[nr] += 1/onionTime*4; //Math.round(slider.value^0.2)+3; //pos[nr]/5;
                //onionskin[nr].style.left = -adir[nr]*pos[nr] + 'px';
                onionskin[nr].style.opacity = 1-pos[nr];
            }
        }
    }

    function updateFps() {
        fps = (1000 / slider.value);
    }

    function updateOnionTime() {
        onionTime = onionSlider.value;
    }

    function updateTimeLine() {
        //Update pointer according to current frame
        //called from updateImage
        var timelinePos = pointer / data.length * 10000;
        timelineSlider.value = timelinePos;
    }

    function slideToImage() {
        pointer = Math.round((timelineSlider.value / 10000) * data.length);
        updateImage();
    }

    function play() {
        if (playBtn.classList.contains('paused')) {
            //pause
            playBtn.classList.remove('paused');
            clearTimeout(playTimeout);
            isPlaying = false;
            size = 'h';
            updateImage();
        } else {
            //play
            playBtn.classList.add('paused');
            resumePlaying();
            size = 'l';
        }
    }

    function resumePlaying() {
        //when the minimum interval has passed for playing 
        //  goto next image
        changeImage(1);
        animateLastFrame(0);
        isPlaying = false;
        playTimeout = setTimeout(resumePlaying, fps);
    }

    function gotoFirst() {
        /*pointer[0] = 'y2018';
        pointer[1] = 'jan1';
        pointer[2] = 'n1';*/
        pointer = 0;
        
        updateImage();
        animateLastFrame(0);
    }

    function gotoLast() {
        /*pointer[0] = 'y2021';
        pointer[1] = 'dec12';
        pointer[2] = 'n31';*/
        pointer = data.length-1;
        
        updateImage();
        animateLastFrame(0);
    }

    function getDate() {
        let date = data[pointer][0];
        return date;
    }

    /*function getDate() {
        //day
        let date = pointer[2].slice(1) + " ";
        //month
        if (pointer[1] === "jan1") {
            date += "januray";
        } else if (pointer[1] === "feb2") {
            date += "february";
        } else if (pointer[1] === "mar3") {
            date += "mars";
        } else if (pointer[1] === "apr4") {
            date += "april";
        } else if (pointer[1] === "maj5") {
            date += "may";
        } else if (pointer[1] === "jun6") {
            date += "june";
        } else if (pointer[1] === "jul7") {
            date += "july";
        } else if (pointer[1] === "aug8") {
            date += "august";
        } else if (pointer[1] === "sep9") {
            date += "september";
        } else if (pointer[1] === "okt10") {
            date += "october";
        } else if (pointer[1] === "nov11") {
            date += "november";
        } else if (pointer[1] === "dec12") {
            date += "december";
        }
        //year
        date += " " + pointer[0].slice(1);
        return date;
    }*/

    function stepForward() {
        //go through the json
        //updateDate();

        changeImage(1);
        animateLastFrame(1);
    }

    function stepBack() {
        //go through the json
        //updateDate();

        changeImage(-1);
        animateLastFrame(-1);
    }

    function updateDate() {
        yy = parseInt(pointer[0].slice(1));
        mm = parseInt(pointer[1].slice(3));
        dd = parseInt(pointer[2].slice(1));
    }

    function changeImage(dir) {
        pointer += dir;
        if (pointer > data.length-1) pointer = 0;
        if (pointer < 0) pointer = data.length-1;
        updateImage();
    }

    /*function gotoCorrectDayInMonth(dir) {
        yy = parseInt(pointer[0].slice(1));
        mm = parseInt(pointer[1].slice(3));
        dd = parseInt(pointer[2].slice(1));

        // while previous day data does not exist & before 1st of the month
        while (!eval("data."+pointer[0]+"."+pointer[1]+".n"+String(dd+dir)) && dd > -1 && dd < 33) {
            // step back one day in the same month
            pointer[2] = "n"+String(dd+dir);
            dd = dd + dir;
        }
        if (eval("data."+pointer[0]+"."+pointer[1]+".n"+String(dd+dir))) {
            //return if landed on a valid day
            pointer[2] = "n"+String(dd+dir);
            updateImage()
            return
        } else {
            //else goto next month
            gotoNextMonth(dir)
            gotoCorrectDayInMonth(dir)
        }
    }*/

    //logs the month before the pointer
    function gotoNextMonth(dir) {
        if (mm == 1 && dir < 0) {
            gotoNextYear(dir);
        }
        if (mm == 12 && dir > 0) {
            gotoNextYear(dir);
        }
        for (key in Object.keys(data.y2021)) {
            if (Object.keys(data.y2021)[key].includes(String(mm+dir))) {
                //set month pointer
                pointer[1] = Object.keys(data.y2021)[key];
                //reset day pointer 
                if (dir > 0) {
                    pointer[2] = 'n0';
                } else {
                    pointer[2] = 'n32';
                }
                updateDate();
                /*console.log(mm + " gotoNextMonth")*/
                return
            }
        }
    }

    function gotoNextYear(dir) {
        if (yy == 2018 && dir < 0) {
            //loop to end
            //reset all pointers
            pointer[0] = 'y2022';
            pointer[1] = 'dec13';
            pointer[2] = 'n32';
            updateDate();
        }
        if (yy == 2021 && dir > 0) {
            //loop to start
            //reset all pointers
            pointer[0] = 'y2017';
            pointer[1] = 'jan0';
            pointer[2] = 'n0';
            updateDate();
        }
        for (key in Object.keys(data)) {
            if (Object.keys(data)[key].includes(String(yy+dir))) {
                //set month pointer
                pointer[0] = Object.keys(data)[key];
                //reset day pointer 
                if (dir > 0) {
                    pointer[1] = 'jan0';
                    pointer[2] = 'n0';
                } else {
                    pointer[1] = 'dec13';
                    pointer[2] = 'n32';
                }
                updateDate();
                return
            }
        }
    }

})();